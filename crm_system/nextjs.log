
> crm_system@0.1.0 dev
> next dev --turbopack --hostname 0.0.0.0 --port 3000

 ⚠ Warning: Found multiple lockfiles. Selecting /Users/charlie.ppy/package-lock.json.
   Consider removing the lockfiles at:
   * /Users/charlie.ppy/Desktop/github_CRM/CRM_system_all/crm_system/package-lock.json

   ▲ Next.js 15.4.5 (Turbopack)
   - Local:        http://localhost:3000
   - Network:      http://0.0.0.0:3000

 ✓ Starting...
 ✓ Compiled middleware in 63ms
 ✓ Ready in 794ms
 ○ Compiling /api/auth/login ...
 ✓ Compiled /api/auth/login in 584ms
 POST /api/auth/login 401 in 1403ms
 ○ Compiling / ...
 ✓ Compiled / in 1018ms
 HEAD / 200 in 1167ms
 ✓ Compiled /login in 189ms
 GET /login?redirect=%2F 200 in 233ms
 ✓ Compiled /api/auth/me in 112ms
 GET /api/auth/me 401 in 140ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 330ms
 POST /api/auth/login 401 in 290ms
 GET /login?redirect=%2F 200 in 86ms
 GET /api/auth/me 401 in 30ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 227ms
 POST /api/auth/login 401 in 284ms
 HEAD / 200 in 60ms
 GET / 200 in 46ms
 GET /api/auth/me 200 in 41ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 228ms
 ⚠ Cross origin request detected from crm.local to /_next/* resource. In a future major version of Next.js, you will need to explicitly configure "allowedDevOrigins" in next.config to allow this.
Read more: https://nextjs.org/docs/app/api-reference/config/next-config-js/allowedDevOrigins
 ✓ Compiled /_not-found/page in 174ms
 GET /_next/webpack-hmr 404 in 239ms
 ✓ Compiled /attendance in 150ms
 GET /attendance 200 in 181ms
 ✓ Compiled /api/attendance/accessible in 53ms
 GET /api/attendance/accessible 200 in 96ms
 GET /api/attendance/accessible 200 in 36ms
 ✓ Compiled /attendance/activity_management in 117ms
 GET /attendance/activity_management 200 in 154ms
 ✓ Compiled /api/activities in 56ms
 GET /api/accounts?role=trainer 200 in 90ms
 GET /api/accounts?role=trainer 200 in 20ms
 GET /api/activities 200 in 360ms
 GET /api/activities 200 in 35ms
 ✓ Compiled /attendance/check in 135ms
 GET /attendance/check 200 in 159ms
 ✓ Compiled /api/attendance/by-date in 61ms
 GET /api/attendance/by-date?date=2025-08-13 200 in 95ms
 GET /api/attendance/by-date?date=2025-08-13 200 in 49ms
 ✓ Compiled /attendance/add in 145ms
 GET /attendance/add 200 in 172ms
 GET /api/activities 200 in 25ms
 GET /api/activities 200 in 26ms
 ✓ Compiled /attendance/by_name in 151ms
 GET /attendance/by_name 200 in 172ms
 GET /api/attendance/accessible 200 in 30ms
 GET /api/attendance/accessible 200 in 31ms
 ✓ Compiled /api/auth/logout in 49ms
 POST /api/auth/logout 200 in 66ms
 GET /login 200 in 20ms
 GET /login?redirect=%2Fattendance%2Fby_name 200 in 20ms
 POST /api/auth/login 401 in 292ms
 POST /api/auth/login 401 in 288ms
 GET /api/attendance/accessible 401 in 43ms
 GET /login?redirect=%2Fattendance%2Fby_name 200 in 49ms
 GET /api/attendance/accessible 401 in 27ms
 GET /login?redirect=%2F 200 in 44ms
 GET /api/auth/me 401 in 23ms
 POST /api/auth/login 401 in 288ms
 GET / 200 in 62ms
 GET /api/auth/me 401 in 31ms
 GET /_next/webpack-hmr 404 in 40ms
 GET /login?redirect=%2F 200 in 19ms
 POST /api/auth/login 401 in 291ms
 GET / 200 in 61ms
 GET /api/auth/me 200 in 46ms
 GET /_next/webpack-hmr 404 in 47ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 241ms
 GET /attendance 200 in 49ms
 GET /api/attendance/accessible 200 in 35ms
 GET /api/attendance/accessible 200 in 33ms
 GET /attendance/activity_management 200 in 35ms
 GET /api/activities 200 in 27ms
 GET /api/accounts?role=trainer 200 in 29ms
 GET /api/accounts?role=trainer 200 in 22ms
 GET /api/activities 200 in 23ms
 GET /attendance/check 200 in 42ms
 GET /api/attendance/by-date?date=2025-08-13 200 in 35ms
 GET /api/attendance/by-date?date=2025-08-13 200 in 28ms
 GET /attendance/add 200 in 36ms
 GET /api/activities 200 in 30ms
 GET /api/activities 200 in 37ms
 GET /attendance/by_name 200 in 40ms
 GET /api/attendance/accessible 200 in 48ms
 GET /api/attendance/accessible 200 in 30ms
 ✓ Compiled /member_management/profile in 119ms
 GET /member_management/profile 200 in 136ms
 GET /api/accounts?role=member 200 in 38ms
 GET /api/accounts?role=member 200 in 26ms
 ✓ Compiled /api/attendance/by-member in 56ms
 GET /api/attendance/by-member?name=%E6%9E%97%E5%A4%AA&contact=50000003 200 in 78ms
 GET /api/attendance/by-member?name=%E6%9E%97%E5%A4%AA&contact=50000003 200 in 19ms
 GET / 200 in 46ms
 GET /api/auth/me 200 in 37ms
 GET /_next/webpack-hmr 404 in 37ms
 POST /api/auth/logout 200 in 38ms
 GET /login 200 in 30ms
 GET /login?redirect=%2F 200 in 30ms
 POST /api/auth/login 401 in 293ms
 GET / 200 in 58ms
 GET /api/auth/me 401 in 25ms
 GET /_next/webpack-hmr 404 in 46ms
 GET /login?redirect=%2F 200 in 21ms
 POST /api/auth/login 200 in 301ms
 GET / 200 in 20ms
 GET / 200 in 17ms
 GET / 200 in 14ms
 GET / 200 in 49ms
 GET /api/auth/me 200 in 40ms
 GET /_next/webpack-hmr 404 in 42ms
 POST /api/auth/logout 200 in 38ms
 GET /login 200 in 30ms
 GET /login?redirect=%2F 200 in 32ms
 POST /api/auth/login 200 in 301ms
 GET / 200 in 24ms
 GET / 200 in 14ms
 GET / 200 in 13ms
 POST /api/auth/login 401 in 267ms
 POST /api/auth/login 200 in 278ms
 POST /api/auth/login 200 in 293ms
 GET / 200 in 67ms
 GET /api/auth/me 200 in 43ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 237ms
 POST /api/auth/logout 200 in 35ms
 GET /login?redirect=%2F 200 in 41ms
 GET /login 200 in 43ms
 POST /api/auth/login 200 in 293ms
 GET / 200 in 20ms
 GET / 200 in 17ms
 GET / 200 in 16ms
 GET / 200 in 69ms
 GET /api/auth/me 401 in 26ms
 GET /_next/webpack-hmr 404 in 45ms
 GET /login?redirect=%2F 200 in 20ms
 POST /api/auth/login 200 in 310ms
 GET / 200 in 17ms
 GET / 200 in 15ms
 GET / 200 in 15ms
 GET / 200 in 57ms
 GET /api/auth/me 200 in 104ms
 GET /_next/webpack-hmr 404 in 56ms
 GET / 200 in 52ms
 GET /api/auth/me 200 in 32ms
 GET / 200 in 56ms
 GET /_next/webpack-hmr 404 in 33ms
 GET / 200 in 44ms
 GET / 200 in 75ms
 GET /api/auth/me 200 in 86ms
 HEAD / 200 in 72ms
 GET / 200 in 50ms
 ⚠ Cross origin request detected from www.in_crm_system.com to /_next/* resource. In a future major version of Next.js, you will need to explicitly configure "allowedDevOrigins" in next.config to allow this.
Read more: https://nextjs.org/docs/app/api-reference/config/next-config-js/allowedDevOrigins
 GET /api/auth/me 401 in 25ms
 GET /_next/webpack-hmr 404 in 43ms
 GET /login?redirect=%2F 200 in 36ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 230ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 226ms
 POST /api/auth/login 401 in 555ms
 POST /api/auth/login 200 in 287ms
 GET / 200 in 24ms
 GET / 200 in 16ms
 GET / 200 in 16ms
 GET /attendance 200 in 41ms
 GET /api/attendance/accessible 200 in 35ms
 GET /api/attendance/accessible 200 in 30ms
 GET /attendance/activity_management 200 in 27ms
 GET /api/activities 200 in 36ms
 GET /api/activities 200 in 22ms
 GET /api/accounts?role=trainer 200 in 106ms
 GET /api/accounts?role=trainer 200 in 20ms
 GET /attendance/check 200 in 33ms
 GET /api/attendance/by-date?date=2025-08-13 200 in 31ms
 GET /api/attendance/by-date?date=2025-08-13 200 in 28ms
 GET /attendance/add 200 in 45ms
 GET /api/activities 200 in 28ms
 GET /api/activities 200 in 20ms
 GET /attendance/by_name 200 in 41ms
 GET /api/attendance/accessible 200 in 34ms
 GET /api/attendance/accessible 200 in 28ms
 GET /attendance 200 in 17ms
 GET /api/attendance/accessible 200 in 32ms
 GET /api/attendance/accessible 200 in 36ms
 GET /attendance/add 200 in 21ms
 GET /api/activities 200 in 21ms
 GET /api/activities 200 in 20ms
 ✓ Compiled /api/accounts/validate-member in 235ms
 GET /api/accounts/validate-member?name=test&contact=12 404 in 108ms
 GET /api/accounts/validate-member?name=test&contact=1 404 in 278ms
 GET /api/accounts/validate-member?name=test&contact=123 404 in 106ms
 GET /api/accounts/validate-member?name=test&contact=1234 404 in 38ms
 GET /api/accounts/validate-member?name=test&contact=12345 404 in 40ms
 GET /api/accounts/validate-member?name=test&contact=123456 404 in 27ms
 GET /api/accounts/validate-member?name=test&contact=1234567 404 in 44ms
 GET /api/accounts/validate-member?name=test&contact=12345678 404 in 43ms
 GET /attendance 200 in 41ms
 GET /api/attendance/accessible 200 in 34ms
 GET /api/attendance/accessible 200 in 34ms
 GET /attendance/add 200 in 42ms
 GET /api/activities 200 in 29ms
 GET /api/activities 200 in 23ms
 GET /api/accounts/validate-member?name=test&contact=%09%2050000003 404 in 50ms
 GET /api/accounts/validate-member?name=test&contact=%0950000003 404 in 47ms
 GET /api/accounts/validate-member?name=test&contact=50000003 404 in 27ms
 GET /attendance/by_name 200 in 46ms
 GET /api/attendance/accessible 200 in 32ms
 GET /api/attendance/accessible 200 in 31ms
 GET /member_management/profile 200 in 40ms
 GET /api/accounts?role=member 200 in 30ms
 GET /api/attendance/by-member?name=%E6%9E%97%E5%A4%AA&contact=50000003 200 in 27ms
 GET /api/accounts?role=member 200 in 28ms
 GET /api/attendance/by-member?name=%E6%9E%97%E5%A4%AA&contact=50000003 200 in 22ms
 ✓ Compiled /trainer_management/profile in 171ms
 GET /trainer_management/profile 200 in 191ms
 GET /api/accounts?role=trainer 200 in 23ms
 GET /api/accounts?role=trainer 200 in 31ms
 ✓ Compiled /api/activities/by-trainer in 59ms
(node:80328) [MONGOOSE] Warning: Duplicate schema index on {"trainerId":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
(Use `node --trace-warnings ...` to show where the warning was created)
 GET /api/activities/by-trainer?trainerId=689318cbb3b09e635ae9f690 200 in 101ms
 GET /api/activities/by-trainer?trainerId=689318cbb3b09e635ae9f690 200 in 43ms
(node:3241) [MONGOOSE] Warning: Duplicate schema index on {"trainerId":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
(Use `node --trace-warnings ...` to show where the warning was created)
 GET /api/trainer-profile/689318cbb3b09e635ae9f690 200 in 566ms
 GET /api/trainer-profile/689318cbb3b09e635ae9f690 200 in 20ms
(node:3242) [MONGOOSE] Warning: Duplicate schema index on {"trainerId":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
(Use `node --trace-warnings ...` to show where the warning was created)
 PUT /api/trainer-profile/689318cbb3b09e635ae9f690 200 in 60ms
(node:3243) [MONGOOSE] Warning: Duplicate schema index on {"trainerId":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
(Use `node --trace-warnings ...` to show where the warning was created)
 PUT /api/trainer-profile/689318cbb3b09e635ae9f690 200 in 56ms
(node:3244) [MONGOOSE] Warning: Duplicate schema index on {"trainerId":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
(Use `node --trace-warnings ...` to show where the warning was created)
 ✓ Compiled /financial_management in 140ms
 GET /financial_management 200 in 162ms
 ✓ Compiled /api/financial-records in 42ms
 GET /api/financial-records 200 in 85ms
 GET /api/financial-records 200 in 34ms
 ✓ Compiled /financial_management/add in 105ms
 GET /financial_management/add 200 in 124ms
開始創建財務記錄...
數據庫連接成功
接收到的請求體: {
  recordType: 'income',
  memberName: 'test',
  item: '器材購買',
  details: '',
  location: '黃大仙',
  unitPrice: 200,
  quantity: 1,
  recordDate: '2025-08-13',
  createdBy: '689308eab3b09e635ae9f4c0'
}
解析後的字段: {
  recordType: 'income',
  memberName: 'test',
  item: '器材購買',
  details: '',
  location: '黃大仙',
  unitPrice: 200,
  quantity: 1,
  recordDate: '2025-08-13',
  createdBy: '689308eab3b09e635ae9f4c0'
}
所有驗證通過，開始創建記錄...
記錄對象創建成功: {
  recordType: 'income',
  memberName: 'test',
  item: '器材購買',
  details: '',
  location: '黃大仙',
  unitPrice: 200,
  quantity: 1,
  recordDate: 2025-08-13T00:00:00.000Z,
  createdBy: new ObjectId('689308eab3b09e635ae9f4c0'),
  _id: new ObjectId('689c2afdfa725512a81144ed')
}
記錄保存成功，ID: new ObjectId('689c2afdfa725512a81144ed')
 POST /api/financial-records 201 in 68ms
 GET /financial_management 200 in 41ms
 GET /api/financial-records 200 in 43ms
 GET /api/financial-records 200 in 36ms
 ✓ Compiled /financial_management/by_name in 133ms
 GET /financial_management/by_name 200 in 155ms
 GET /api/financial-records 200 in 37ms
 GET /api/financial-records? 200 in 37ms
 GET /api/financial-records? 200 in 37ms
 GET /api/financial-records 200 in 38ms
 ✓ Compiled /financial_management/report in 130ms
 GET /financial_management/report 200 in 153ms
 GET /api/financial-records 200 in 38ms
 GET /api/financial-records 200 in 34ms
 GET /financial_management/add 200 in 44ms
 GET /financial_management 200 in 39ms
 GET /api/financial-records 200 in 47ms
 GET /api/financial-records 200 in 37ms
 GET /financial_management 200 in 222ms
 GET /api/auth/me 200 in 48ms
 GET /_next/webpack-hmr 404 in 49ms
 GET /api/financial-records 200 in 60ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 245ms
 GET /financial_management/add 200 in 94ms
開始創建財務記錄...
數據庫連接成功
接收到的請求體: {
  recordType: 'income',
  memberName: '王太',
  item: '器材購買',
  details: '',
  location: '黃大仙',
  unitPrice: 50,
  quantity: 1,
  recordDate: '2025-08-13T06:08',
  createdBy: '689308eab3b09e635ae9f4c0'
}
解析後的字段: {
  recordType: 'income',
  memberName: '王太',
  item: '器材購買',
  details: '',
  location: '黃大仙',
  unitPrice: 50,
  quantity: 1,
  recordDate: '2025-08-13T06:08',
  createdBy: '689308eab3b09e635ae9f4c0'
}
所有驗證通過，開始創建記錄...
記錄對象創建成功: {
  recordType: 'income',
  memberName: '王太',
  item: '器材購買',
  details: '',
  location: '黃大仙',
  unitPrice: 50,
  quantity: 1,
  recordDate: 2025-08-12T22:08:00.000Z,
  createdBy: new ObjectId('689308eab3b09e635ae9f4c0'),
  _id: new ObjectId('689c2bd2fa725512a8114511')
}
記錄保存成功，ID: new ObjectId('689c2bd2fa725512a8114511')
 POST /api/financial-records 201 in 52ms
 GET /financial_management 200 in 42ms
 GET /api/financial-records 200 in 63ms
 GET /api/financial-records 200 in 37ms
 GET /financial_management 200 in 213ms
 GET /api/auth/me 200 in 55ms
 GET /_next/webpack-hmr 404 in 56ms
 GET /api/financial-records 200 in 63ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 257ms
 GET /financial_management/add 200 in 98ms
開始創建財務記錄...
數據庫連接成功
接收到的請求體: {
  recordType: 'income',
  memberName: '陳仔',
  item: '課程費用',
  details: '',
  location: '黃大仙',
  unitPrice: 20,
  quantity: 1,
  recordDate: '2025-08-13T06:14',
  createdBy: '689308eab3b09e635ae9f4c0'
}
解析後的字段: {
  recordType: 'income',
  memberName: '陳仔',
  item: '課程費用',
  details: '',
  location: '黃大仙',
  unitPrice: 20,
  quantity: 1,
  recordDate: '2025-08-13T06:14',
  createdBy: '689308eab3b09e635ae9f4c0'
}
所有驗證通過，開始創建記錄...
記錄對象創建成功: {
  recordType: 'income',
  memberName: '陳仔',
  item: '課程費用',
  details: '',
  location: '黃大仙',
  unitPrice: 20,
  quantity: 1,
  recordDate: 2025-08-12T22:14:00.000Z,
  createdBy: new ObjectId('689308eab3b09e635ae9f4c0'),
  _id: new ObjectId('689c2d62fa725512a811451d')
}
記錄保存成功，ID: new ObjectId('689c2d62fa725512a811451d')
 POST /api/financial-records 201 in 55ms
 GET /financial_management 200 in 51ms
 GET /api/financial-records 200 in 43ms
 GET /api/financial-records 200 in 43ms
 GET /api/financial-records 200 in 49ms
 GET /api/financial-records 200 in 127ms
 GET /financial_management 200 in 66ms
 GET /api/auth/me 200 in 73ms
 GET /_next/webpack-hmr 404 in 75ms
 GET /api/financial-records 200 in 87ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 268ms
