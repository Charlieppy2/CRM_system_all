
> crm_system@0.1.0 dev
> next dev --turbopack --hostname 0.0.0.0 --port 3000

 ⚠ Warning: Found multiple lockfiles. Selecting /Users/charlie.ppy/package-lock.json.
   Consider removing the lockfiles at:
   * /Users/charlie.ppy/Desktop/github_CRM/CRM_system_all/crm_system/package-lock.json

   ▲ Next.js 15.4.5 (Turbopack)
   - Local:        http://localhost:3000
   - Network:      http://0.0.0.0:3000

 ✓ Starting...
 ✓ Compiled middleware in 77ms
 ✓ Ready in 1002ms
 ○ Compiling /api/financial-records ...
 ✓ Compiled /api/financial-records in 544ms
 GET /api/financial-records 200 in 1616ms
 ○ Compiling /financial_management ...
 ✓ Compiled /financial_management in 1062ms
 GET /financial_management 200 in 1212ms
 GET /financial_management 200 in 66ms
 ⚠ Cross origin request detected from www.in_crm_system.com to /_next/* resource. In a future major version of Next.js, you will need to explicitly configure "allowedDevOrigins" in next.config to allow this.
Read more: https://nextjs.org/docs/app/api-reference/config/next-config-js/allowedDevOrigins
 GET /api/financial-records 200 in 62ms
 GET /api/auth/me 200 in 208ms
 ✓ Compiled /api/auth/me in 238ms
 GET /_next/webpack-hmr 404 in 279ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 380ms
 GET /financial_management 200 in 58ms
 GET /api/auth/me 200 in 52ms
 GET /_next/webpack-hmr 404 in 53ms
 GET /api/financial-records 200 in 65ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 254ms
 GET /financial_management 200 in 53ms
 GET /financial_management 200 in 46ms
 GET /financial_management/report 200 in 350ms
 GET / 200 in 359ms
 ✓ Compiled / in 391ms
 GET /financial_management/by_name 200 in 417ms
 ⚠ Cross origin request detected from crm.local to /_next/* resource. In a future major version of Next.js, you will need to explicitly configure "allowedDevOrigins" in next.config to allow this.
Read more: https://nextjs.org/docs/app/api-reference/config/next-config-js/allowedDevOrigins
 GET /api/auth/me 200 in 40ms
 GET /_next/webpack-hmr 404 in 41ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 245ms
 ✓ Compiled /attendance in 126ms
 GET /attendance 200 in 146ms
 ✓ Compiled /api/attendance/accessible in 52ms
 GET /api/attendance/accessible 200 in 86ms
 GET /api/attendance/accessible 200 in 27ms
 GET /financial_management 200 in 44ms
 GET /api/financial-records 200 in 42ms
 GET /api/financial-records 200 in 41ms
 GET /financial_management/by_name 200 in 42ms
 GET /api/financial-records 200 in 41ms
 GET /api/financial-records? 200 in 42ms
 GET /api/financial-records 200 in 39ms
 GET /api/financial-records? 200 in 39ms
 GET /financial_management/report 200 in 41ms
 GET /api/financial-records 200 in 78ms
 GET /api/financial-records 200 in 40ms
 ✓ Compiled /financial_management/add in 117ms
 GET /financial_management/add 200 in 138ms
 ✓ Compiled /trainer_management/profile in 127ms
 GET /trainer_management/profile 200 in 147ms
 ✓ Compiled /api/accounts in 48ms
 GET /api/accounts?role=trainer 200 in 82ms
 GET /api/accounts?role=trainer 200 in 32ms
 ✓ Compiled /api/activities/by-trainer in 57ms
(node:8123) [MONGOOSE] Warning: Duplicate schema index on {"trainerId":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
(Use `node --trace-warnings ...` to show where the warning was created)
 GET /api/activities/by-trainer?trainerId=689318cbb3b09e635ae9f690 200 in 91ms
 GET /api/activities/by-trainer?trainerId=689318cbb3b09e635ae9f690 200 in 27ms
(node:8544) [MONGOOSE] Warning: Duplicate schema index on {"trainerId":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
(Use `node --trace-warnings ...` to show where the warning was created)
 GET /api/trainer-profile/689318cbb3b09e635ae9f690 200 in 511ms
 GET /api/trainer-profile/689318cbb3b09e635ae9f690 200 in 21ms
(node:8545) [MONGOOSE] Warning: Duplicate schema index on {"trainerId":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
(Use `node --trace-warnings ...` to show where the warning was created)
 GET / 200 in 40ms
 GET /api/financial-records? 200 in 52ms
 GET /api/financial-records?memberName=%E9%99%B3%E4%BB%94 200 in 57ms
 GET /api/financial-records?memberName=%E7%81%A3%E4%BB%94 200 in 58ms
 GET /api/financial-records?memberName=%E7%81%A3 200 in 54ms
 GET /api/financial-records? 200 in 56ms
 GET /financial_management/by_name 200 in 41ms
 GET /api/financial-records 200 in 39ms
 GET /api/financial-records? 200 in 39ms
 GET /api/financial-records 200 in 38ms
 GET /api/financial-records? 200 in 39ms
 GET /financial_management/report 200 in 45ms
 GET /api/financial-records 200 in 59ms
 GET /api/financial-records 200 in 38ms
 GET /financial_management/by_name 200 in 29ms
 GET /api/financial-records? 200 in 45ms
 GET /api/financial-records 200 in 46ms
 GET /api/financial-records 200 in 38ms
 GET /api/financial-records? 200 in 48ms
 GET /api/financial-records?memberName=test 200 in 70ms
 GET /api/financial-records?memberName=%E9%99%B3%E4%BB%94 200 in 45ms
 GET /api/financial-records?memberName=test 200 in 42ms
 GET /api/financial-records? 200 in 45ms
 GET /financial_management/report 200 in 30ms
 GET /api/financial-records 200 in 40ms
 GET /api/financial-records 200 in 34ms
 GET /api/financial-records 200 in 57ms
 GET /api/financial-records 200 in 45ms
 GET /api/financial-records 200 in 40ms
 GET /api/financial-records 200 in 51ms
 GET /api/financial-records 200 in 57ms
 GET /api/financial-records 200 in 59ms
 GET /api/financial-records 200 in 51ms
 GET /api/financial-records 200 in 64ms
 GET /financial_management/add 200 in 43ms
 GET /financial_management 200 in 52ms
 GET /api/financial-records 200 in 41ms
 GET /api/financial-records 200 in 36ms
 GET /financial_management/by_name 200 in 41ms
 GET /api/financial-records 200 in 43ms
 GET /api/financial-records? 200 in 46ms
 GET /api/financial-records 200 in 42ms
 GET /api/financial-records? 200 in 44ms
 GET /financial_management/report 200 in 42ms
 GET /api/financial-records 200 in 43ms
 GET /api/financial-records 200 in 37ms
 GET /financial_management/add 200 in 42ms
 GET /financial_management/report 200 in 24ms
 GET /api/financial-records 200 in 38ms
 GET /api/financial-records 200 in 44ms
 GET /api/financial-records 200 in 63ms
 GET /financial_management/by_name 200 in 42ms
 GET /api/financial-records? 200 in 41ms
 GET /api/financial-records 200 in 43ms
 GET /api/financial-records? 200 in 42ms
 GET /api/financial-records 200 in 43ms
 GET /financial_management 200 in 42ms
 GET /api/financial-records 200 in 43ms
 GET /api/financial-records 200 in 36ms
 GET /financial_management/add 200 in 41ms
 GET /financial_management/report 200 in 42ms
 GET /api/financial-records 200 in 39ms
 GET /api/financial-records 200 in 36ms
 GET /api/financial-records 200 in 50ms
 GET /api/financial-records 200 in 38ms
 GET /api/financial-records 200 in 39ms
 GET /api/financial-records 200 in 40ms
 GET /api/financial-records 200 in 55ms
 GET /financial_management/report 200 in 210ms
 GET /api/auth/me 200 in 69ms
 GET /_next/webpack-hmr 404 in 70ms
 GET /api/financial-records 200 in 83ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 265ms
 GET /financial_management 200 in 36ms
 GET /api/financial-records 200 in 38ms
 GET /api/financial-records 200 in 36ms
 GET /financial_management/by_name 200 in 55ms
 GET /api/financial-records 200 in 48ms
 GET /api/financial-records? 200 in 47ms
 GET /api/financial-records? 200 in 45ms
 GET /api/financial-records 200 in 47ms
 GET /financial_management/report 200 in 44ms
 GET /api/financial-records 200 in 44ms
 GET /api/financial-records 200 in 37ms
 GET /financial_management/add 200 in 43ms
 GET /financial_management/report 200 in 41ms
 GET /api/financial-records 200 in 45ms
 GET /api/financial-records 200 in 41ms
 GET /financial_management/by_name 200 in 40ms
 GET /api/financial-records? 200 in 54ms
 GET /api/financial-records 200 in 56ms
 GET /api/financial-records 200 in 44ms
 GET /api/financial-records? 200 in 45ms
 GET /financial_management/report 200 in 42ms
 GET /financial_management/report 200 in 19ms
 GET /api/financial-records 200 in 39ms
 GET /api/financial-records 200 in 34ms
 GET /financial_management/report 200 in 40ms
 GET /api/financial-records 200 in 41ms
 GET /api/financial-records 200 in 36ms
 GET /financial_management/add 200 in 37ms
 GET /financial_management 200 in 40ms
 GET /api/financial-records 200 in 43ms
 GET /api/financial-records 200 in 39ms
 GET /financial_management/report 200 in 38ms
 GET /api/financial-records 200 in 38ms
 GET /api/financial-records 200 in 37ms
 GET /api/financial-records 200 in 46ms
 GET /api/financial-records 200 in 59ms
 GET /api/financial-records 200 in 59ms
 GET /financial_management 200 in 42ms
 GET /api/financial-records 200 in 41ms
 GET /api/financial-records 200 in 39ms
 ✓ Compiled /api/financial-records/[id] in 86ms
Error: Route "/api/financial-records/[id]" used `params.id`. `params` should be awaited before using its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at PUT (src/app/api/financial-records/[id]/route.ts:11:38)
   9 | ) {
  10 |   try {
> 11 |     console.log('開始修改財務記錄...', params.id);
     |                                      ^
  12 |     
  13 |     await connectDB();
  14 |     console.log('數據庫連接成功');
開始修改財務記錄... 689c2d62fa725512a811451d
數據庫連接成功
接收到的修改數據: {
  recordType: 'income',
  memberName: '陳仔',
  item: '課程費用',
  details: '',
  location: '黃大仙',
  unitPrice: 300,
  quantity: 1,
  recordDate: '2025-08-13'
}
Error: Route "/api/financial-records/[id]" used `params.id`. `params` should be awaited before using its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at PUT (src/app/api/financial-records/[id]/route.ts:50:13)
  48 |     // 查找並更新記錄
  49 |     const updatedRecord = await FinancialRecord.findByIdAndUpdate(
> 50 |       params.id,
     |             ^
  51 |       {
  52 |         recordType,
  53 |         memberName,
記錄更新成功: new ObjectId('689c2d62fa725512a811451d')
 PUT /api/financial-records/689c2d62fa725512a811451d 200 in 1054ms
 GET /api/financial-records 200 in 61ms
 GET /attendance 200 in 46ms
 GET /api/attendance/accessible 200 in 48ms
 GET /api/attendance/accessible 200 in 39ms
 ✓ Compiled /attendance/activity_management in 134ms
 GET /attendance/activity_management 200 in 155ms
 GET /api/accounts?role=trainer 200 in 31ms
 ✓ Compiled /api/activities in 60ms
 GET /api/accounts?role=trainer 200 in 48ms
 GET /api/activities 200 in 94ms
 GET /api/activities 200 in 35ms
 ✓ Compiled /attendance/check in 119ms
 GET /attendance/check 200 in 142ms
 ✓ Compiled /api/attendance/by-date in 54ms
 GET /api/attendance/by-date?date=2025-08-13 200 in 114ms
 GET /api/attendance/by-date?date=2025-08-13 200 in 54ms
 ✓ Compiled /attendance/add in 106ms
 GET /attendance/add 200 in 126ms
 GET /api/activities 200 in 21ms
 GET /api/activities 200 in 28ms
 ✓ Compiled /attendance/by_name in 125ms
 GET /attendance/by_name 200 in 146ms
 GET /api/attendance/accessible 200 in 29ms
 GET /api/attendance/accessible 200 in 40ms
 ✓ Compiled /member_management/profile in 130ms
 GET /member_management/profile 200 in 151ms
 GET /api/accounts?role=member 200 in 29ms
 GET /api/accounts?role=member 200 in 27ms
 ✓ Compiled /api/attendance/by-member in 52ms
 GET /api/attendance/by-member?name=%E6%9E%97%E5%A4%AA&contact=50000003 200 in 77ms
 GET /api/attendance/by-member?name=%E6%9E%97%E5%A4%AA&contact=50000003 200 in 22ms
 GET /trainer_management/profile 200 in 40ms
 GET /api/accounts?role=trainer 200 in 26ms
 GET /api/accounts?role=trainer 200 in 35ms
 GET /api/activities/by-trainer?trainerId=689318cbb3b09e635ae9f690 200 in 35ms
 GET /api/trainer-profile/689318cbb3b09e635ae9f690 200 in 37ms
 GET /api/trainer-profile/689318cbb3b09e635ae9f690 200 in 28ms
 GET /api/activities/by-trainer?trainerId=689318cbb3b09e635ae9f690 200 in 35ms
(node:9810) [MONGOOSE] Warning: Duplicate schema index on {"trainerId":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
(Use `node --trace-warnings ...` to show where the warning was created)
 GET /api/activities/by-trainer?trainerId=68930b69b3b09e635ae9f4e6 200 in 38ms
 GET /api/trainer-profile/68930b69b3b09e635ae9f4e6 404 in 43ms
(node:9811) [MONGOOSE] Warning: Duplicate schema index on {"trainerId":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
(Use `node --trace-warnings ...` to show where the warning was created)
 GET /api/trainer-profile/689318cbb3b09e635ae9f690 200 in 38ms
 GET /api/activities/by-trainer?trainerId=689318cbb3b09e635ae9f690 200 in 43ms
(node:9812) [MONGOOSE] Warning: Duplicate schema index on {"trainerId":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
(Use `node --trace-warnings ...` to show where the warning was created)
 GET /api/trainer-profile/68930b69b3b09e635ae9f4e6 404 in 35ms
 GET /api/activities/by-trainer?trainerId=68930b69b3b09e635ae9f4e6 200 in 43ms
(node:9813) [MONGOOSE] Warning: Duplicate schema index on {"trainerId":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
(Use `node --trace-warnings ...` to show where the warning was created)
 GET /financial_management 200 in 42ms
 GET /api/financial-records 200 in 44ms
 GET /api/financial-records 200 in 37ms
 GET /financial_management/by_name 200 in 35ms
 GET /api/financial-records 200 in 59ms
 GET /api/financial-records? 200 in 59ms
 GET /api/financial-records? 200 in 58ms
 GET /api/financial-records 200 in 61ms
 GET /financial_management/report 200 in 35ms
 GET /api/financial-records 200 in 45ms
 GET /api/financial-records 200 in 38ms
 GET /financial_management/report 200 in 219ms
 GET /api/auth/me 200 in 49ms
 GET /_next/webpack-hmr 404 in 51ms
 GET /api/financial-records 200 in 62ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 255ms
 GET /api/financial-records 200 in 45ms
 GET /api/financial-records 200 in 44ms
